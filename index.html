<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abella Joias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<style>
body{background:#F8F6F2}
.font-serif{font-family:'Cinzel',serif}
.gold{color:#A68966}
</style>
</head>

<body class="max-w-7xl mx-auto p-4">

<!-- TOPO -->
<header class="text-center mb-6">
  <h1 class="font-serif text-3xl gold tracking-widest">Abella Joias</h1>
  <p class="text-xs uppercase tracking-widest text-gray-400">Cat√°logo Online</p>
</header>

<!-- CATEGORIAS -->
<div id="menuCategorias" class="flex gap-2 overflow-x-auto pb-4 mb-6"></div>

<!-- PRODUTOS -->
<div id="listaProdutos"
     class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
</div>

<!-- CARRINHO -->
<a href="checkout.html"
   class="fixed bottom-5 right-5 bg-black text-white px-6 py-3 rounded-full text-xs tracking-widest">
Finalizar Pedido
</a>

<script>
/* üî• FIREBASE */
firebase.initializeApp({
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  databaseURL: "https://SEU_PROJETO-default-rtdb.firebaseio.com",
  projectId: "SEU_PROJETO"
});

const db = firebase.database();
const lista = document.getElementById('listaProdutos');
const menu = document.getElementById('menuCategorias');

let produtos = [];
let categoriaAtiva = 'todos';

/* üóÇÔ∏è CATEGORIAS */
db.ref('categories').on('value', snap => {
  menu.innerHTML = `
    <button onclick="filtrar('todos')"
      class="px-4 py-2 border text-xs uppercase ${categoriaAtiva==='todos'?'bg-black text-white':'bg-white'}">
      Todos
    </button>
  `;

  snap.forEach(s=>{
    const nome = s.val().name;
    menu.innerHTML += `
      <button onclick="filtrar('${nome}')"
        class="px-4 py-2 border text-xs uppercase ${categoriaAtiva===nome?'bg-black text-white':'bg-white'}">
        ${nome}
      </button>`;
  });
});

/* üì¶ PRODUTOS */
db.ref('products').on('value', snap => {
  produtos = [];
  snap.forEach(s=>{
    produtos.push({ id:s.key, ...s.val() });
  });
  render();
});

/* üîé FILTRO */
function filtrar(cat){
  categoriaAtiva = cat;
  render();
}

/* üñºÔ∏è RENDER */
function render(){
  lista.innerHTML = '';
  produtos
    .filter(p => categoriaAtiva==='todos' || p.category===categoriaAtiva)
    .forEach(p=>{
      lista.innerHTML += `
      <div class="bg-white border">
        <img src="${p.image}"
          class="aspect-square object-cover w-full">

        <div class="p-3">
          <p class="text-sm">${p.name}</p>
          <p class="text-xs text-gray-400">${p.category}</p>
          <p class="gold font-semibold mt-1">R$ ${p.price.toFixed(2)}</p>

          <button onclick="addCarrinho('${p.id}')"
            class="mt-2 w-full border py-2 text-xs uppercase">
            Adicionar
          </button>
        </div>
      </div>`;
    });
}

/* üõí CARRINHO */
function addCarrinho(id){
  const p = produtos.find(x=>x.id===id);
  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  const i = cart.find(x=>x.id===id);
  if(i){
    i.qty++;
  }else{
    cart.push({
      id:p.id,
      name:p.name,
      price:p.price,
      weight:p.weight || 0,
      qty:1
    });
  }

  localStorage.setItem('cart', JSON.stringify(cart));
  alert('Produto adicionado!');
}
</script>

</body>
</html>
