<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abella Joias | Atacado Premium</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<style>
body{background:#fcfaf7}
.gold{color:#b8860b}
.card{border:1px solid #e5e3dd;border-radius:18px}
.selo{
 position:absolute;top:-10px;right:-10px;
 background:linear-gradient(135deg,#ffd700,#ffec8b);
 color:#6b4f00;font-size:10px;font-weight:800;
 padding:10px;border-radius:50%;
 border:2px solid white;
}
.old{font-size:12px;text-decoration:line-through;color:#999}
</style>
</head>

<body>

<!-- HEADER -->
<header class="bg-white border-b p-6 flex justify-between items-center">
  <h1 class="font-extrabold gold text-xl">ABELLA JOIAS</h1>
  <button onclick="irCheckout()" class="bg-black text-white px-6 py-2 rounded-full">
    ðŸ›’ Carrinho (<span id="qtdCarrinho">0</span>)
  </button>
</header>

<!-- PRODUTOS -->
<main class="max-w-6xl mx-auto p-6">
  <div id="produtos" class="grid grid-cols-1 md:grid-cols-4 gap-8"></div>
</main>

<script>
/* FIREBASE */
firebase.initializeApp({
 apiKey: "AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
 authDomain: "catalogo-abella-joias.firebaseapp.com",
 databaseURL: "https://catalogo-abella-joias-default-rtdb.firebaseio.com",
 projectId: "catalogo-abella-joias"
});
const db=firebase.database();

/* CARRINHO */
let carrinho=JSON.parse(localStorage.getItem('carrinho'))||[];
qtdCarrinho.innerText=carrinho.length;

/* SELLOS */
let selos={};
db.ref('selos').once('value').then(s=>selos=s.val()||{});

/* PRODUTOS */
db.ref('produtos').once('value').then(s=>{
 const dados=s.val();
 if(!dados) return;
 Object.keys(dados).forEach(id=>{
   const p=dados[id];
   let desconto=0, seloTxt='';
   if(p.selo && selos[p.selo]){
     desconto=selos[p.selo].desconto;
     seloTxt=`<div class="selo">${selos[p.selo].nome}</div>`;
   }
   const precoDesc = desconto ? (p.preco*(1-desconto/100)) : p.preco;

   produtos.innerHTML+=`
   <div class="card bg-white p-4 relative">
     ${seloTxt}
     <img src="${p.imagem}" class="h-40 mx-auto object-contain mb-4">
     <h2 class="font-bold text-sm">${p.nome}</h2>

     ${desconto?`<div class="old">R$ ${p.preco.toFixed(2)}</div>`:''}
     <div class="font-bold gold text-lg">
       R$ ${precoDesc.toFixed(2)}
     </div>

     <button onclick='addCarrinho(${JSON.stringify({...p,preco:precoDesc,id})})'
       class="mt-4 w-full bg-black text-white py-2 rounded-full text-sm">
       ADICIONAR
     </button>
   </div>`;
 });
});

/* FUNÃ‡Ã•ES */
function addCarrinho(p){
 let item=carrinho.find(i=>i.id===p.id);
 if(item) item.qtd++;
 else carrinho.push({...p,qtd:1});
 localStorage.setItem('carrinho',JSON.stringify(carrinho));
 qtdCarrinho.innerText=carrinho.length;
}

function irCheckout(){
 window.location.href='checkout_premium.html';
}
</script>

</body>
</html>
