<!-- PAINEL3 FINAL AJUSTADO | ABELLA JOIAS -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Admin | Abella Joias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{font-family:Poppins;background:#f8f6f2}
.serif{font-family:Cinzel}
.gold{color:#A68966}
</style>
</head>

<body>

<header class="bg-white border-b sticky top-0 z-50">
  <div class="max-w-6xl mx-auto p-6 flex justify-between items-center">
    <h1 class="serif text-xl gold tracking-widest">Abella Joias</h1>
    <nav class="flex gap-6 text-xs font-bold uppercase tracking-widest">
      <button onclick="setView('empresa')">Empresa</button>
      <button onclick="setView('categorias')">Categorias</button>
      <button onclick="setView('produtos')">Produtos</button>
      <button onclick="setView('promocoes')">Promoções</button>
      <button onclick="setView('pedidos')">Pedidos</button>
    </nav>
  </div>
</header>

<main class="max-w-6xl mx-auto p-6">

<!-- PEDIDOS -->
<section id="pedidos" class="hidden">
  <h2 class="serif gold text-xl mb-6">Pedidos</h2>
  <div id="listaPedidos" class="space-y-3"></div>
</section>

</main>

<!-- MODAL PEDIDO -->
<div id="modalPedido" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-50">
<div class="bg-white rounded-2xl p-6 w-full max-w-2xl overflow-y-auto max-h-[90vh]">

<h3 class="serif gold text-lg mb-4">Detalhes do Pedido</h3>
<div id="detalhesPedido"></div>

<div class="flex gap-3 mt-6">
<button onclick="gerarRomaneio('simples')" class="flex-1 bg-gray-100 py-2 rounded-lg text-xs font-bold">Romaneio Simples</button>
<button onclick="gerarRomaneio('completo')" class="flex-1 bg-gray-100 py-2 rounded-lg text-xs font-bold">Romaneio Completo</button>
<button onclick="gerarRomaneio('foto')" class="flex-1 bg-black text-white py-2 rounded-lg text-xs font-bold">Romaneio com Foto</button>
</div>

<button onclick="fecharModal()" class="mt-4 text-xs text-gray-400">Fechar</button>
</div>
</div>

<script>
// FIREBASE
firebase.initializeApp({
  apiKey:"AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
  databaseURL:"https://catalogo-abella-joias-default-rtdb.firebaseio.com"
});
const db=firebase.database();

// FUNÇÃO MOEDA BR
function moedaBR(v){
  return Number(v||0).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
}

// PEDIDOS
db.ref('orders').on('value',snap=>{
  const lista=document.getElementById('listaPedidos');
  lista.innerHTML='';
  snap.forEach(s=>{
    const p=s.val();
    lista.innerHTML+=`
    <div class="bg-white border rounded-xl p-4 flex justify-between items-center">
      <div>
        <p class="text-xs font-bold">${p.cliente}</p>
        <p class="text-[10px] text-gray-400">${p.data}</p>
      </div>
      <div class="text-right">
        <p class="text-xs gold font-bold">${p.total}</p>
        <button onclick='abrirPedido(${JSON.stringify(p)})' class="text-[10px] underline">Detalhes</button>
      </div>
    </div>`;
  });
});

// MODAL
function abrirPedido(p){
  const d=document.getElementById('detalhesPedido');
  d.innerHTML=`
    <p class="text-xs mb-2"><b>Cliente:</b> ${p.cliente}</p>
    <p class="text-xs mb-2"><b>Pagamento:</b> ${p.pagamento}</p>
    <hr class="my-3">
    ${p.itens.map(i=>`
      <div class="flex justify-between text-xs mb-1">
        <span>${i.name} (${i.quantidade}x)</span>
        <span>${moedaBR(i.precoFinal*i.quantidade)}</span>
      </div>
    `).join('')}
    <hr class="my-3">
    <p class="font-bold gold text-right">${p.total}</p>
  `;
  document.getElementById('modalPedido').style.display='flex';
}

function fecharModal(){
  document.getElementById('modalPedido').style.display='none';
}

function gerarRomaneio(tipo){
  alert('Romaneio '+tipo+' gerado (estrutura painel3)');
}

// VIEW
function setView(id){
  document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id)?.classList.remove('hidden');
}
setView('pedidos');
</script>

</body>
</html>

